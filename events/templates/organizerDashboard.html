{% extends "event.html" %}
{% load static %}

{% block content %}
<link rel="stylesheet" href="{% static 'CSS/organizer_dashboard.css' %}">

<section class="container mx-auto px-4 md:px-6 pt-6 pb-1">
    <!-- Header Section -->
    <div class="section-header">
        <div>
            {% if user_type == "Admin" %}
                <h1 class="section-title">Manage Events</h1>
                <p class="text-gray-600 text-sm mt-1">Administrator dashboard for managing all events and categories</p>
            {% elif user_type == "Organizer" %}
                <h1 class="section-title">Organizer Dashboard</h1>
                <p class="text-gray-600 text-sm mt-1">Manage your events and track participant engagement</p>
            {% elif user_type == "Participant" %}
                <h1 class="section-title">All Events</h1>
                <p class="text-gray-600 text-sm mt-1">Discover and join amazing events tailored for you</p>
            {% endif %}
        </div>
        
        {% if user_type == 'Admin' or user_type == "Organizer" %}
            <div class="header-actions">
                <a href="{% url 'event-form' %}" class="btn-primary">
                    <i class="fas fa-plus"></i> New Event
                </a>
                <a href="{% url 'create-category' %}" class="btn-secondary">
                    <i class="fas fa-tag"></i> New Category
                </a>    
            </div>        
        {% endif %}
    </div>

    <!-- Stats Grid -->
    <section class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
        <a href="{% url 'organizer-dashboard' %}?type=all&title=All" class="block">
            <div class="stats-card">
                <div class="flex items-center justify-between">
                    <div>
                        {% if user_type == 'Admin' or user_type == 'Organizer' %}
                            <p class="stats-label">All Events</p>
                            <p class="stats-number">{{counts.total_event}}</p>
                        {% else %}
                            <p class="stats-label">Explore Events</p>
                            <p class="stats-number">All</p>
                        {% endif %}
                    </div>
                    <div class="stats-icon bg-[#18BC9C]/20 text-[#18BC9C]">
                        <i class="fas fa-calendar"></i>
                    </div>
                </div>
            </div>
        </a>

        <a href="{% url 'organizer-dashboard' %}?type=upcoming&title=Upcoming" class="block">
            <div class="stats-card">
                <div class="flex items-center justify-between">
                    <div>
                        {% if user_type == 'Admin' or user_type == 'Organizer' %}
                            <p class="stats-label">Upcoming Events</p>
                            <p class="stats-number">{{counts.upcoming}}</p>
                        {% else %}
                            <p class="stats-label">Upcoming for You</p>
                            <p class="stats-number">{{counts.upcoming}}</p>
                        {% endif %}
                    </div>
                    <div class="stats-icon bg-red-100 text-red-500">
                        <i class="fa-solid fa-calendar-plus"></i>
                    </div>
                </div>
            </div>
        </a>
        
        <a href="{% url 'organizer-dashboard' %}?type=past&title=Past" class="block">
            <div class="stats-card">
                <div class="flex items-center justify-between">
                    <div>
                        {% if user_type == 'Admin' or user_type == 'Organizer' %}
                            <p class="stats-label">Past Events</p>
                            <p class="stats-number">{{counts.past}}</p>
                        {% else %}
                            <p class="stats-label">All Attended Events</p>
                            <p class="stats-number">{{counts.past}}</p>
                        {% endif %}
                    </div>
                    <div class="stats-icon bg-[#2C3E50]/20 text-[#2C3E50]">
                        <i class="fa-solid fa-calendar-check"></i>
                    </div>
                </div>
            </div>
        </a>
        
        <div class="stats-card">
            <div class="flex items-center justify-between">
                <div>
                    {% if user_type == 'Admin' or user_type == 'Organizer' %}
                        <p class="stats-label">Total Participants</p>
                        <p class="stats-number">{{total_Participants}}</p>
                    {% else %}
                        <p class="stats-label">Join the Community</p>
                        <p class="stats-number">{{total_Participants}}+</p>
                    {% endif %}
                </div>
                <div class="stats-icon bg-[#18BC9C]/20 text-[#18BC9C]">
                    <i class="fas fa-users"></i>
                </div>
            </div>
        </div>
    </section>

    <!-- Messages -->
    {% if messages %}
        {% for message in messages %}
            <div class="message-alert message-success">
                <i class="fas fa-check-circle"></i>
                <span>{{ message }}</span>
            </div>
        {% endfor %}
    {% endif %}

    <!-- Search Section -->
    <section class="grid grid-cols-1 lg:grid-cols-3 gap-4 mb-6">
        <!-- Filter Form -->
        <div class="search-section lg:col-span-2">
            <h3 class="text-lg font-bold text-gray-800 mb-3">Filter Events</h3>
            <form action="" method="POST" class="space-y-4">
                {% csrf_token %}
                <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                    <div>
                        <label class="form-label">Category</label>
                        <select name="category" class="form-input">
                            <option value="">All Categories</option>
                            {% for category in all_category %}
                            <option value="{{ category.id }}">{{ category.name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div>
                        <label class="form-label">From Date</label>
                        <input type="date" name="from_date" class="form-input">
                    </div>
                    <div>
                        <label class="form-label">To Date</label>
                        <input type="date" name="to_date" class="form-input">
                    </div>
                </div>
                
                <div class="pt-1">
                    <button type="submit" class="search-btn">
                        <i class="fas fa-search mr-2"></i> Apply Filters
                    </button>
                </div>
            </form>
        </div>
        
        <!-- Search Form -->
        <div class="search-section">
            <h3 class="text-lg font-bold text-gray-800 mb-3">Search Events</h3>
            <form method="GET" action="{% url 'organizer-dashboard' %}">
                <div class="space-y-3">
                    <div>
                        <label class="form-label">Event Name or Keyword</label>
                        <input type="text" 
                               class="form-input" 
                               name="search" 
                               placeholder="Search events..." 
                               value="{{ result }}">
                    </div>
                    
                    <button type="submit" class="search-btn">
                        <i class="fas fa-search mr-2"></i>
                        Search Events
                    </button>
                </div>
            </form>        
        </div>
    </section>
</section>
{% endblock content %}
